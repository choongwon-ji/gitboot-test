# 원스토어 인앱결제 적용을 위한 사전준비

## **상품 등록하기** <a href="#id-02." id="id-02."></a>

원스토어 개발자센터 > APPS 페이지에 접속하여 상품 등록 버튼을 클릭하고 상품을 등록합니다.

상품을 등록하면 애플리케이션 ID(AID)가 발급됩니다. ****&#x20;

<figure><img src="../../.gitbook/assets/image (9).png" alt=""><figcaption></figcaption></figure>



## **정산 정보 등록하기**  <a href="#id-02." id="id-02."></a>

유료 상품(인앱상품)을 등록하여 판매하기 위해서는, 우선 정산 정보를 등록해야 합니다.

회원 유형 별로 입력하는 정보나 제출해야 하는 서류가 다를 수 있습니다. 개발자 회원 관련 자세한 내용은 개발자 가이드 문서 내 [회원 파트](https://dev.onestore.co.kr/wiki/ko/x/AgAY)를 참고하시기 바랍니다.

* 정산 정보 : 개발자센터 > 회원정보 관리 > 회원정보의 정산정보 탭 클릭
* 사업자 회원은 정산정보를 등록하신 후 운영자의 승인을 받아야 합니다.

<figure><img src="../../.gitbook/assets/image (1) (1).png" alt=""><figcaption></figcaption></figure>



## **인앱상품 등록하기**  <a href="#id-02." id="id-02."></a>

개발자센터 > APPS > In-App정보 페이지에서 인앱상품을 등록할 수 있습니다.

인앱상품은 관리형 상품과 구독형 상품으로 구성되어 있습니다. &#x20;

### 관리형 상품 개별 등록하기 <a href="#id-02." id="id-02."></a>

* in-App정보 화면의 관리상품 메뉴에서 'In-App상품등록' 버튼을 클릭하여 관리상품을 등록합니다.
* In-App ID : 해당 상품의 In-App ID를 입력하고 중복 체크를 합니다. In-App ID는 앱 내에서 유일한 값이어야 합니다.
* In-App 상품제목 : 상품의 제목을 입력합니다. 제목은 결제화면 및 구매내역에 노출됩니다.
* In-App 상품경로 : 앱 내에서 해당 인앱상품을 확인할 수 있는 경로로, 필수 값은 아닙니다. 해당 정보는 원스토어 검증팀이 검증 시 활용합니다.
* In-App 상품가격 : 인앱상품의 판매 가격을 입력합니다. 부가세를 포함한 금액을 입력하시면 됩니다.
* 모든 입력이 완료되었으면 하단의 '저장' 버튼을 클릭합니다.

<figure><img src="../../.gitbook/assets/image (7) (1).png" alt=""><figcaption></figcaption></figure>

### **관리형 상품 일괄 등록하기** <a href="#id-02." id="id-02."></a>

* step 1> '일괄등록 양식 다운로드' 버튼을 클릭하여 양식 파일을 다운로드 합니다.
* step 2> 다운로드한 양식에 인앱상품 정보를 입력합니다.
* step 3> '상품 일괄등록' 버튼을 클릭하여 인앱상품 정보가 등록된 파일을 업로드합니다.
* step 4> 인앱상품이 모두 정상적으로 등록되었는지 확인합니다.

{% hint style="info" %}
다운로드한 인앱상품 일괄 등록 양식에 최대 500개의 인앱상품만 등록 가능합니다.

500개 이상 등록이 필요한 경우에는 500개씩 나누어 등록하시기 바랍니다.
{% endhint %}

### 구독형 상품 등록하기 <a href="#id-02." id="id-02."></a>

* in-App정보 화면의 구독상품 메뉴에서 'In-App 상품등록' 버튼을 클릭하여 구독상품을 등록합니다.
* In-App ID : 해당 상품의 In-App ID를 입력하고 중복 체크를 합니다. In-App ID는 앱 내에서 유일한 값이어야 합니다.
* 구독 상품제목 : 상품의 제목을 입력합니다. 제목은 결제화면 및 구매내역에 노출됩니다.
* 구독 상품경로 : 앱 내에서 해당 인앱상품을 확인할 수 있는 경로로, 필수 값은 아닙니다. 해당 정보는 원스토어 검증팀이 검증 시 활용합니다.
* 구독상품 기본가격 : 구독상품의 기본 판매 가격을 입력합니다. 부가세를 포함한 금액을 입력하시면 됩니다.
* 구독상품 결제기간 : 구독상품을 이용할 수 있는 기간을 선택하면 됩니다. 선택한 기간 단위로 결제가 갱신됩니다.&#x20;
  * 주간/월간/3개월/6개월/연간

{% hint style="info" %}
월간 상품의 경우 익월 동일일에 결제가 됩니다. (3개월, 6개월 상품도 동일하게 동작합니다.)&#x20;

예를들어, 1월 15일에 정기 결제가 시작되었다면, 2월 15일에 다음 결제가 발생합니다.&#x20;



하지만 동일일이 없는 경우에는 그 달의 마지막 날이 결제 갱신일이 됩니다. &#x20;

예를들어, 1월 31일에 정기 결제가 시작되었다면, 2월 28일(혹은 29일)에 다음 결제가 발생하고, 3월 28일(혹은 29)에 그 다음 결제가 발생합니다.&#x20;
{% endhint %}

* 무료 구독 기간 : 무료 구독 기간을 제공하면, 고객은 해당 구독 상품을 체험해보고 구독을 이용할 지 결정할 수있습니다. 무료 구독은 동일 고객에게 구독 상품별로 1회이상 제공되지 않습니다. &#x20;
* 신규 할인 프로모션 가격: 신규할인 프로모션 가격과 제공 기간을 선택할 수 있습니다. 신규할인 프로모션 가격은 구독상품 기본가격보다 높을 수 없습니다.&#x20;

{% hint style="info" %}
신규 할인 프로모션 결제 기간은 구독상품의 결제기간을 따릅니다.&#x20;

예를들어, 결제기간이 월간인 구독상품의 경우 3 결제기간으로 설정하면 고객은 3번의 결제가 발생하는 동안(3개월 동안) 할인된 가격이 적용됩니다.&#x20;
{% endhint %}

*   결제 유예기간 : 결제 수단에 문제가 발생하는 경우 고객에게 유예기간을 제공할지 결정 할 수 있습니다. 유예기간을 제공하는 경우 고객은 유예기간동안 콘텐츠를 정상적으로 이용할 수 있습니다.&#x20;

    결제 수단에 문제가 발생하는 경우 결제 유예기간을 설정하지 않아도 구독이 바로 해지되지 않습니다. 사용자의 계정은 보류 상태가 되고, 보류 상태에서 결제문제를 해결하면 다시 정기 결제가 이루어집니다.  &#x20;
* 모든 입력이 완료되었으면 하단의 '저장' 버튼을 클릭합니다.

<figure><img src="../../.gitbook/assets/image (8).png" alt=""><figcaption></figcaption></figure>



#### 구독상품 설정 관리 <a href="#id-02." id="id-02."></a>

* 구독상품 메뉴에서 구독상품 설정 관리 버튼을 누릅니다.&#x20;
* 해당 메뉴에서 일시중지 및 구독 별 무료 이용 사용 여부를 설정할 수 있습니다.&#x20;
* 일시중지 및 구독 별 무료 이용은 구독 상품 전체에 적용됩니다.&#x20;

<figure><img src="../../.gitbook/assets/image (5).png" alt=""><figcaption></figcaption></figure>

****

## **라이선스 키(Public Key) 및 OAuth 인증 정보 확인하기**  <a href="#id-02.-publickey-oauth" id="id-02.-publickey-oauth"></a>

원스토어 개발자센터 > Apps > In-App정보 > 'In-App API 관리' 버튼을 클릭하면 라이선스 키와 서버 API를 위한 OAuth 인증 정보를 확인할 수 있습니다.

<figure><img src="../../.gitbook/assets/image (2) (1).png" alt=""><figcaption></figcaption></figure>

* 라이선스 키 : 원스토어가 전달한 인앱결제 내역의 위변조 여부를 확인하는 용도로 사용합니다.
*   OAuth 인증 정보 : 원스토어 서버 API를 사용하기 위한 인증 용도로 사용합니다.\


    <figure><img src="../../.gitbook/assets/image (6).png" alt=""><figcaption></figcaption></figure>



## **원스토어 인앱결제 Sample App 다운로드** <a href="#id-02.-sampleapp" id="id-02.-sampleapp"></a>

원스토어 인앱결제 API V7(SDK V21)를 사용하기 위해 필요한 샘플 앱을 [깃허브(github](https://github.com/ONE-store/onestore\_iap\_release))에서 다운로드 받을 수 있습니다.&#x20;



## **인앱결제 라이브러리 추가하기**  <a href="#id-02." id="id-02."></a>

프로젝트 최상위 _build.gradle_ 파일에 원스토어 maven 주소를 등록합니다.

```
allprojects {
    repositories {
    ...
        maven { url 'https://repo.onestore.co.kr/repository/onestore-sdk-public' }
    }
}
```

다음은 앱의 _build.gradle_ 파일에 원스토어 결제 라이브러리 종속 항목을 추가합니다.

```
dependencies {
   implementation "com.onestorecorp.sdk:sdk-iap:21.00.01"
   implementation "com.onestorecorp.sdk:sdk-configuration-kr:1.0.0"
}
```

****

## **원스토어 앱 설치하기**  <a href="#id-02." id="id-02."></a>

개발자나 사용자가 원스토어 인앱결제를 이용하기 위해서는 원스토어 서비스(ONE store Service, OSS) 앱이 필요합니다.

원스토어 서비스는 국내 통신사(SKT, KT, U+)를 통해 출시되는 안드로이드 스마트폰에는 기본적으로 탑재되어 있지만, 해외출시 단말(Pixel 등)이나 태블릿의 경우 원스토어 앱이 설치되어 있지 않습니다.

원스토어 인앱결제 모듈을 개발하는 단말의 상황에 따라 다음의 가이드를 이용하여 원스토어 서비스를 다운로드 받아 최신 상태로 만들어 주어야 합니다.

* **국내 통신사에서 출시된 스마트폰**\
  통신사를 통해 출시된 안드로이드 스마트폰의 경우 원스토어 앱들이 기본 탑재되어 있습니다.\
  개발자는 기본 탑재되어 있는 원스토어(ONE store client, OSC) 앱을 이용해 원스토어 앱들을 최신 버전으로 업데이트 할 수 있습니다.\
  스마트폰에 설치 된 원스토어(or T Store or 올레 마켓 or U+ 스토어)을 실행하시어 원스토어 클라이언트 및 원스토어 서비스를 업데이트 하시면 됩니다. (주의 : 오래된 단말의 경우 자동 업데이트가 지원되지 않을 수 있습니다.)\
  \

* **해외향 스마트폰/태블릿 및 제조사 유통 단말**\
  해외향 스마트폰이나 태블릿, 제조사 유통 단말의 경우 원스토어 앱들이 기본 탑재가 되어 있지 않기 때문에, 원스토어 클라이언트 및 원스토어 서비스를 다운 받아 설치를 해주셔야 합니다.\
  다음 링크를 클릭하여 인앱결제 개발에 필요한 원스토어 앱들을 설치해 주시기 바랍니다. (모바일에서만 열립니다.)\
  [원스토어 클라이언트 및 서비스 다운로드 하러 가기](https://m.onestore.co.kr/mobilepoc/etc/downloadGuide.omp?PrePageNm=/main)

{% hint style="info" %}
원스토어 인앱결제는 Android OS버전이 5.0 이상인 안드로이드 디바이스에서 동작합니다. 인앱결제 모듈 연동 전 단말의 OS 버전을 확인해주세요.
{% endhint %}
